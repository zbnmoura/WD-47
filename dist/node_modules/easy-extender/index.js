"use strict";var _=require("lodash"),EasyExtender=function(n,t){return this.plugins={},this.pluginOptions={},this.returnValues={},this.hooks=t,this.defaultPlugins=n,this};EasyExtender.prototype.init=function(){this.defaultPlugins&&Object.keys(this.defaultPlugins).forEach(function(n){_.isUndefined(this.plugins[n])&&(this.plugins[n]=this.defaultPlugins[n])},this);return this},EasyExtender.prototype.initUserPlugins=function(){var n=_.toArray(arguments),t=_.difference(Object.keys(this.plugins),Object.keys(this.defaultPlugins));t.length&&t.forEach(function(t){var i={};this.pluginOptions&&(i=this.pluginOptions[t]),this.returnValues[t].push({value:this.get(t).apply(null,[i].concat(n))}),_.isUndefined(i)||_.isUndefined(i.enabled)?this.enablePlugin(t):i.enabled?this.enablePlugin(t):this.disablePlugin(t)},this)},EasyExtender.prototype.wrap=function(n,t){this.registerPlugin({"plugin:name":t,plugin:function(){return n}})},EasyExtender.prototype.get=function(n){return!_.isUndefined(this.plugins[n])&&(this.plugins[n].plugin||!1)},EasyExtender.prototype.registerPlugin=function(n,t,i){var e;if(!_.isFunction(n.plugin))return!!_.isFunction(i)&&i("Module must implement a .plugin() method");!i&&t&&(_.isFunction(t)?i=t:e=t);var s=_.isUndefined(n["plugin:name"])?_.uniqueId():n["plugin:name"];return this.pluginOptions[s]=e,this.returnValues[s]=[],this.plugins[s]=n,_.isFunction(i)&&i(null),this.disablePlugin(s),this},EasyExtender.prototype.getPlugin=function(n){return _.isString(n)&&(n=this.plugins[n]),n||!1},EasyExtender.prototype.disablePlugin=function(n){return(n=this.getPlugin(n))._enabled=!1,n},EasyExtender.prototype.enablePlugin=function(n){return(n=this.getPlugin(n))._enabled=!0,n},EasyExtender.prototype.hook=function(n){var t=Array.prototype.slice.call(arguments,1),i=[];return _.each(this.plugins,function(t){t.hooks&&(_.isUndefined(t.hooks[n])||i.push(t.hooks[n]))}),this.hooks[n].apply(this,[i].concat(t))},EasyExtender.prototype.getReturnValues=function(n){return this.returnValues[n]||[]},module.exports=EasyExtender;