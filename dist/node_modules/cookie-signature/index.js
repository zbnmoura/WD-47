"use strict";var crypto=require("crypto");function sha1(e){return crypto.createHash("sha1").update(e).digest("hex")}exports.sign=function(e,r){if("string"!=typeof e)throw new TypeError("Cookie value must be provided as a string.");if("string"!=typeof r)throw new TypeError("Secret string must be provided.");return e+"."+crypto.createHmac("sha256",r).update(e).digest("base64").replace(/\=+$/,"")},exports.unsign=function(e,r){if("string"!=typeof e)throw new TypeError("Signed cookie string must be provided.");if("string"!=typeof r)throw new TypeError("Secret string must be provided.");var t=e.slice(0,e.lastIndexOf("."));return sha1(exports.sign(t,r))==sha1(e)&&t};