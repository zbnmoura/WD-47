"use strict";var util=require("util"),define=require("define-property"),CacheBase=require("cache-base"),Emitter=require("component-emitter"),isObject=require("isobject"),merge=require("mixin-deep"),pascal=require("pascalcase"),cu=require("class-utils");function namespace(e){var t=e?CacheBase.namespace(e):CacheBase,i=[];function n(e,i){if(!(this instanceof n))return new n(e,i);t.call(this,e),this.is("base"),this.initBase(e,i)}return util.inherits(n,t),Emitter(n),n.prototype.initBase=function(t,r){this.options=merge({},this.options,r),this.cache=this.cache||{},this.define("registered",{}),e&&(this[e]={}),this.define("_callbacks",this._callbacks),isObject(t)&&this.visit("set",t),n.run(this,"use",i)},n.prototype.is=function(e){if("string"!=typeof e)throw new TypeError("expected name to be a string");return this.define("is"+pascal(e),!0),this.define("_name",e),this.define("_appname",e),this},n.prototype.isRegistered=function(e,t){return!!this.registered.hasOwnProperty(e)||(!1!==t&&(this.registered[e]=!0,this.emit("plugin",e)),!1)},n.prototype.use=function(e){return e.call(this,this),this},n.prototype.define=function(e,t){return isObject(e)?this.visit("define",e):(define(this,e,t),this)},n.prototype.mixin=function(e,t){return n.prototype[e]=t,this},n.prototype.mixins=n.prototype.mixins||[],Object.defineProperty(n.prototype,"base",{configurable:!0,get:function(){return this.parent?this.parent.base:this}}),define(n,"use",function(e){return i.push(e),n}),define(n,"run",function(e,t,i){for(var r=i.length,s=0;r--;)e[t](i[s++]);return n}),define(n,"extend",cu.extend(n,function(e,t){return e.prototype.mixins=e.prototype.mixins||[],define(e,"mixin",function(t){var i=t(e.prototype,e);return"function"==typeof i&&e.prototype.mixins.push(i),e}),define(e,"mixins",function(t){return n.run(t,"mixin",e.prototype.mixins),e}),e.prototype.mixin=function(t,i){return e.prototype[t]=i,this},n})),define(n,"mixin",function(e){var t=e(n.prototype,n);return"function"==typeof t&&n.prototype.mixins.push(t),n}),define(n,"mixins",function(e){return n.run(e,"mixin",n.prototype.mixins),n}),define(n,"inherit",cu.inherit),define(n,"bubble",cu.bubble),n}module.exports=namespace(),module.exports.namespace=namespace;