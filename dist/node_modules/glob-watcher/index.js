"use strict";var gaze=require("gaze"),EventEmitter=require("events").EventEmitter;module.exports=function(e,n,t){var r=new EventEmitter;"function"==typeof n&&(t=n,n={});var o=gaze(e,n,function(e,n){e&&r.emit("error",e),n.on("all",function(e,n,o){var i={type:e,path:n};o&&(i.old=o),r.emit("change",i),t&&t(i)})});return o.on("end",r.emit.bind(r,"end")),o.on("error",r.emit.bind(r,"error")),o.on("ready",r.emit.bind(r,"ready")),o.on("nomatch",r.emit.bind(r,"nomatch")),r.end=function(){return o.close()},r.add=function(){return o.add.apply(o,arguments)},r.remove=function(){return o.remove()},r._watcher=o,r};