"use strict";var fs=require("fs"),path=require("path"),isPlainObject=require("is-plain-object"),pick=require("object.pick"),defaults=require("object.defaults/immutable"),expandTilde=require("expand-tilde"),parsePath=require("parse-filepath");function fined(t,e){var n=expandPath(t,e);return n?findWithExpandedPath(n):null}function expandPath(t,e){var n;if(isPlainObject(e)||(e={}),isString(t)&&(t={path:t}),isPlainObject(t)||(t={}),!isString((t=defaults(t,e)).path))return null;isString(t.name)&&t.name?t.path?(n=expandTilde(t.path.toString()),n=path.join(n,t.name.toString())):n=t.name.toString():n=expandTilde(t.path.toString());var i=createExtensionArray(t.extensions),r=createExtensionMap(t.extensions),a=isString(t.cwd)?t.cwd.toString():".";a=path.resolve(expandTilde(a));var s=!!t.findUp,l=parsePath(n);return l.isAbsolute?(n=n.slice(l.root.length),s=!1,a=l.root):l.root&&(n=n.slice(l.root.length),a=path.resolve(l.root)),{path:n,basedir:a,findUp:s,extArr:i,extMap:r}}function findWithExpandedPath(t){var e=t.findUp?findUpFile(t.basedir,t.path,t.extArr):findFile(t.basedir,t.path,t.extArr);return e?(t.extMap&&(e.extension=pick(t.extMap,e.extension)),e):null}function findFile(t,e,n){for(var i=path.resolve(t,e),r=0,a=n.length;r<a;r++){var s=i+n[r];try{return fs.statSync(s),{path:s,extension:n[r]}}catch(t){}}return null}function findUpFile(t,e,n){var i;do{var r=findFile(t,e,n);if(r)return r;i=t,t=path.dirname(t)}while(i!==t);return null}function createExtensionArray(t){return isString(t)?[t]:Array.isArray(t)?(t=t.filter(isString)).length>0?t:[""]:isPlainObject(t)&&(t=Object.keys(t)).length>0?t:[""]}function createExtensionMap(t){return isPlainObject(t)?isEmpty(t)?{"":null}:t:null}function isEmpty(t){return!Object.keys(t).length}function isString(t){return"string"==typeof t||"[object String]"===Object.prototype.toString.call(t)}module.exports=fined;