"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},PARAM_REGEXP=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,TEXT_REGEXP=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,TOKEN_REGEXP=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,QESC_REGEXP=/\\([\u000b\u0020-\u00ff])/g,QUOTE_REGEXP=/([\\"])/g,TYPE_REGEXP=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;function format(e){if(!e||"object"!==(void 0===e?"undefined":_typeof(e)))throw new TypeError("argument obj is required");var t=e.parameters,r=e.type;if(!r||!TYPE_REGEXP.test(r))throw new TypeError("invalid type");var n=r;if(t&&"object"===(void 0===t?"undefined":_typeof(t)))for(var o,i=Object.keys(t).sort(),a=0;a<i.length;a++){if(o=i[a],!TOKEN_REGEXP.test(o))throw new TypeError("invalid parameter name");n+="; "+o+"="+qstring(t[o])}return n}function parse(e){if(!e)throw new TypeError("argument string is required");var t="object"===(void 0===e?"undefined":_typeof(e))?getcontenttype(e):e;if("string"!=typeof t)throw new TypeError("argument string is required to be a string");var r=t.indexOf(";"),n=-1!==r?t.substr(0,r).trim():t.trim();if(!TYPE_REGEXP.test(n))throw new TypeError("invalid media type");var o=new ContentType(n.toLowerCase());if(-1!==r){var i,a,f;for(PARAM_REGEXP.lastIndex=r;a=PARAM_REGEXP.exec(t);){if(a.index!==r)throw new TypeError("invalid parameter format");r+=a[0].length,i=a[1].toLowerCase(),'"'===(f=a[2])[0]&&(f=f.substr(1,f.length-2).replace(QESC_REGEXP,"$1")),o.parameters[i]=f}if(r!==t.length)throw new TypeError("invalid parameter format")}return o}function getcontenttype(e){var t;if("function"==typeof e.getHeader?t=e.getHeader("content-type"):"object"===_typeof(e.headers)&&(t=e.headers&&e.headers["content-type"]),"string"!=typeof t)throw new TypeError("content-type header is missing from object");return t}function qstring(e){var t=String(e);if(TOKEN_REGEXP.test(t))return t;if(t.length>0&&!TEXT_REGEXP.test(t))throw new TypeError("invalid parameter value");return'"'+t.replace(QUOTE_REGEXP,"\\$1")+'"'}function ContentType(e){this.parameters=Object.create(null),this.type=e}exports.format=format,exports.parse=parse;